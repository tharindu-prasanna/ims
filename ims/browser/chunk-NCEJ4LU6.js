import{a as T}from"./chunk-XLBN6B6R.js";import{a as F}from"./chunk-EHXRGKF7.js";import{a as ue,g as L,h as P}from"./chunk-VVU5YSG6.js";import"./chunk-BF2ZRDXQ.js";import{f as be,g as ve,h as ye,i as ge,j as Se,k as Be}from"./chunk-ZTY3N64Q.js";import{b as G,c as f,e as O,f as U,g as C,h as I,j as q,k as Q,l as $,n as he,o as E,p as fe}from"./chunk-YPAZ5YN4.js";import{a as le,b as me}from"./chunk-OEBJFCBM.js";import"./chunk-7RKSVCTK.js";import{f as B,j as x,m as oe,n as se,p as _,q as ce,t as de,u as w,v as pe}from"./chunk-PHRS766U.js";import{Aa as v,C as g,D as R,Fa as z,H as j,I as k,Oa as J,Qa as W,Sa as ee,Ta as te,Va as ie,Y as m,Z as l,a as M,f as y,fa as u,ib as re,jb as ne,la as Z,ma as t,n as D,na as a,oa as d,sa as K,tb as ae,ua as b,va as A,vb as N,wb as S,y as V,ya as Y,yb as X,za as s}from"./chunk-6SFOHSVE.js";var Re=["filter"];function Ne(o,i){if(o&1){let h=K();t(0,"div",13)(1,"button",14),b("click",function(){j(h);let e=A(),n=Y(12);return k(e.clear(n))}),a(),t(2,"span",15),d(3,"i",16),t(4,"input",17,18),b("input",function(e){j(h);let n=A(),c=Y(12);return k(n.onGlobalFilter(c,e))}),a()()()}}function Le(o,i){o&1&&(t(0,"tr")(1,"th",19)(2,"div",20),s(3," Code "),t(4,"div",21),d(5,"p-sortIcon",22)(6,"p-columnFilter",23),a()()(),t(7,"th",24)(8,"div",20),s(9," Name "),t(10,"div",21),d(11,"p-sortIcon",25)(12,"p-columnFilter",26),a()()(),t(13,"th",27)(14,"div",20),s(15," Created At "),t(16,"div",21),d(17,"p-sortIcon",28)(18,"p-columnFilter",29),a()()(),t(19,"th",30)(20,"div",20),s(21," Created By "),t(22,"div",21),d(23,"p-sortIcon",31)(24,"p-columnFilter",32),a()()(),t(25,"th",33)(26,"div",34),s(27," Updated At "),t(28,"div",21),d(29,"p-sortIcon",35)(30,"p-columnFilter",36),a()()(),t(31,"th",37)(32,"div",20),s(33," Updated By "),t(34,"div",21),d(35,"p-sortIcon",38)(36,"p-columnFilter",39),a()()(),t(37,"th",33)(38,"div",40),s(39,"Actions"),a()()())}function Pe(o,i){if(o&1){let h=K();t(0,"tr")(1,"td"),s(2),a(),t(3,"td"),s(4),a(),t(5,"td",41),s(6),J(7,"date"),a(),t(8,"td",41),s(9),a(),t(10,"td",41),s(11),J(12,"date"),a(),t(13,"td",41),s(14),a(),t(15,"td")(16,"div",42)(17,"p-button",43),b("click",function(e){let c=j(h).$implicit,p=A();return k(p.onEdit(e,c._id))}),a(),t(18,"p-button",44),b("click",function(e){let c=j(h).$implicit,p=A();return k(p.onDelete(e,c._id))}),a()()()()}if(o&2){let h=i.$implicit;m(2),v(h.code),m(2),v(h.name),m(2),v(W(7,10,h.createdAt,"yyyy-MM-dd")),m(3),v(h.createdBy),m(2),v(W(12,13,h.updatedAt,"yyyy-MM-dd")),m(3),v(h.updatedBy),m(3),u("rounded",!0)("text",!0),m(1),u("rounded",!0)("text",!0)}}function Ge(o,i){o&1&&(t(0,"tr")(1,"td",45),s(2,"No branches found."),a()())}function Oe(o,i){o&1&&(t(0,"tr")(1,"td",45),s(2,"Loading branches. Please wait."),a()())}var Ue=()=>[10,25,50,100,250],qe=()=>["code","name","createdAt","createdBy","updatedAt","updatedBy"],Ee=(()=>{let i=class i{constructor(r,e,n,c,p){this.router=r,this.confirmationService=e,this.messageService=n,this.branchService=c,this.encryptionService=p,this.branches=[],this.loading=!1,this.subscription=new y}ngOnInit(){this.getBranches()}ngOnDestroy(){this.subscription.unsubscribe()}getBranches(){this.loading=!0,this.subscription=this.branchService.getBranches().pipe(D(r=>r.message),D(r=>{let e=["code","name","createdBy"];return r.map(n=>{let c=M({},n);return this.encryptionService.decryptObjectValues(c,e),c})})).subscribe(r=>{this.branches=r,this.loading=!1},r=>{this.messageService.add({closable:!1,life:6e3,icon:"pi pi-times",summary:r.error.message}),this.loading=!1})}onGlobalFilter(r,e){r.filterGlobal(e.target.value,"contains")}clear(r){r.clear(),this.filter.nativeElement.value=""}onEdit(r,e){this.router.navigate(["/system_data/branches/edit",e])}onDelete(r,e){this.confirmationService.confirm({target:r.target,message:"Are you sure to delete this branch?",icon:"pi pi-exclamation-triangle",accept:()=>{this.loading=!0,this.subscription=this.branchService.deleteBranch(e).subscribe(n=>{this.loading=!1,this.getBranches(),this.messageService.add({closable:!1,life:6e3,icon:"pi pi-check",summary:n.message})},n=>{this.loading=!1,this.messageService.add({closable:!1,life:6e3,icon:"pi pi-times",summary:n.error.message})})}})}};i.\u0275fac=function(e){return new(e||i)(l(N),l(B),l(x),l(T),l(F))},i.\u0275cmp=g({type:i,selectors:[["app-branches"]],viewQuery:function(e,n){if(e&1&&te(Re,5),e&2){let c;ee(c=ie())&&(n.filter=c.first)}},decls:18,vars:11,consts:[[1,"grid"],[1,"col-12"],[1,"card"],[1,"md:flex","md:justify-content-between","mb-3"],[1,"mb-3","md:mb-0"],["pRipple","","icon","pi pi-plus","label","Add New Branch","routerLink","/system_data/branches/add",1,"w-full","md:max-w-fit",3,"raised"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","responsiveLayout","scroll","styleClass","p-datatable-gridlines",3,"value","rows","showCurrentPageReport","rowsPerPageOptions","loading","rowHover","paginator","globalFilterFields"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Clear","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2",3,"click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search Keyword",1,"w-full",3,"input"],["filter",""],["pSortableColumn","code",2,"min-width","8rem"],[1,"flex","justify-content-between","align-items-center"],[1,"flex","vertically-center","gap-2"],["field","code"],["type","text","field","code","display","menu","placeholder","Search by code"],["pSortableColumn","description",2,"min-width","14rem"],["field","name"],["type","text","field","name","display","menu","placeholder","Search by name"],["pSortableColumn","createdAt",2,"min-width","8rem"],["field","createdAt"],["type","text","field","createdAt","display","menu","placeholder","Search by created date"],["pSortableColumn","createdBy",2,"min-width","8rem"],["field","createdBy"],["type","text","field","createdBy","display","menu","placeholder","Search by user created by"],[2,"min-width","8rem"],["pSortableColumn","updatedAt",1,"flex","justify-content-between","align-items-center"],["field","updatedAt"],["type","text","field","updatedAt","display","menu","placeholder","Search by updated date"],["pSortableColumn","updatedBy",2,"min-width","8rem"],["field","updatedBy"],["type","text","field","updatedBy","display","menu","placeholder","Search by user updated by"],[1,"flex","justify-content-center","align-items-center"],[1,"text-center"],[1,"flex","flex-wrap","gap-2","justify-content-center","align-items-center"],["pRipple","","icon","pi pi-pencil","pTooltip","Edit branch","tooltipPosition","top",3,"rounded","text","click"],["pRipple","","severity","danger","icon","pi pi-trash","pTooltip","Delete branch","tooltipPosition","top",3,"rounded","text","click"],["colspan","12"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h5"),s(6,"Manage Branches"),a(),t(7,"p",4),s(8,"You can view, search, and edit branches details through this page."),a()(),t(9,"div"),d(10,"p-button",5),a()(),t(11,"p-table",6,7),Z(13,Ne,6,0,"ng-template",8)(14,Le,40,0,"ng-template",9)(15,Pe,19,16,"ng-template",10)(16,Ge,3,0,"ng-template",11)(17,Oe,3,0,"ng-template",12),a()()()()),e&2&&(m(10),u("raised",!0),m(1),u("value",n.branches)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",z(9,Ue))("loading",n.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",z(10,qe)))},dependencies:[S,de,w,oe,E,_,ve,ye,ge,Se,le,re]});let o=i;return o})();var De=(()=>{let i=class i{constructor(r,e,n,c,p){this.confirmationService=r,this.messageService=e,this.utilityService=n,this.branchService=c,this.encryptionService=p,this.transferData=!1,this.submitBtnIcon="pi pi-plus",this.submitBtnLabel="Add Branch",this.subscription=new y,this.addBranchForm=new C({})}ngOnInit(){this.addBranchForm=new C({code:new I("",[f.required,this.utilityService.trimmedEmptyValidator,f.maxLength(20)]),name:new I("",[f.required,this.utilityService.trimmedEmptyValidator,f.maxLength(80)])})}ngOnDestroy(){this.subscription.unsubscribe()}setDataTransferStatus(){this.addBranchForm.disable(),this.transferData=!0,this.submitBtnIcon="pi pi-spinner pi-spin",this.submitBtnLabel="Please wait"}unsetDataTransferStatus(){this.addBranchForm.enable(),this.transferData=!1,this.submitBtnIcon="pi pi-plus",this.submitBtnLabel="Add Branch"}getFormData(){return{code:this.encryptionService.encryptData(this.addBranchForm.get("code").value),name:this.encryptionService.encryptData(this.addBranchForm.get("name").value)}}addBranch(r){this.confirmationService.confirm({target:r.target,message:"Are you sure to add this branch?",icon:"pi pi-exclamation-triangle",accept:()=>{this.setDataTransferStatus(),this.subscription=this.branchService.setBranch(this.getFormData()).subscribe(e=>{this.unsetDataTransferStatus(),this.addBranchForm.reset(),this.messageService.add({closable:!1,life:6e3,icon:"pi pi-check",summary:e.message})},e=>{this.unsetDataTransferStatus(),this.messageService.add({closable:!1,life:6e3,icon:"pi pi-times",summary:e.error.message})})}})}};i.\u0275fac=function(e){return new(e||i)(l(B),l(x),l(P),l(T),l(F))},i.\u0275cmp=g({type:i,selectors:[["app-add-branch"]],decls:22,vars:7,consts:[[1,"grid"],[1,"col-12"],[1,"card"],[3,"formGroup"],[1,"grid","p-fluid","mt-3"],[1,"field","col-12","md:col-4"],[1,"p-float-label"],["formControlName","code","type","text","id","code","pInputText",""],["for","code"],[1,"field","col-12","md:col-8"],["formControlName","name","type","text","id","name","pInputText",""],["for","name"],[1,"block","md:flex","md:justify-content-between"],["styleClass","justify-content-center w-full md:w-8rem mb-3 md:mb-0","pRipple","","label","Back","icon","pi pi-arrow-left","routerLink","/system_data/branches",1,"block",3,"raised","disabled"],["styleClass","justify-content-center w-full md:w-9rem","pRipple","","severity","success",1,"block",3,"raised","label","icon","disabled","click"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),s(4,"Add New Branch"),a(),t(5,"p"),s(6,"Please provide the necessary details to add a new branch."),a(),t(7,"form",3)(8,"div",4)(9,"div",5)(10,"span",6),d(11,"input",7),t(12,"label",8),s(13,"Branch code"),a()()(),t(14,"div",9)(15,"span",6),d(16,"input",10),t(17,"label",11),s(18,"Branch name"),a()()()()(),t(19,"div",12),d(20,"p-button",13),t(21,"p-button",14),b("click",function(p){return n.addBranch(p)}),a()()()()()),e&2&&(m(7),u("formGroup",n.addBranchForm),m(13),u("raised",!0)("disabled",n.transferData),m(1),u("raised",!0)("label",n.submitBtnLabel)("icon",n.submitBtnIcon)("disabled",n.addBranchForm.invalid||n.transferData))},dependencies:[S,w,E,_,q,G,O,U,Q,$]});let o=i;return o})();var je=(()=>{let i=class i{constructor(r,e,n,c,p,Ae,Me,Ve){this.confirmationService=r,this.messageService=e,this.utilityService=n,this.branchService=c,this.encryptionService=p,this.route=Ae,this.router=Me,this.store=Ve,this.branchId="",this.branch={},this.transferData=!1,this.submitBtnIcon="pi pi-sync",this.submitBtnLabel="Update Branch",this.subscription=new y,this.editBranchForm=new C({})}ngOnInit(){this.editBranchForm=new C({code:new I("",[f.required,this.utilityService.trimmedEmptyValidator,f.maxLength(20)]),name:new I("",[f.required,this.utilityService.trimmedEmptyValidator,f.maxLength(80)])}),this.subscription=this.route.paramMap.subscribe(r=>{this.branchId=r.get("id")??"",this.getBranch(this.branchId)})}ngOnDestroy(){this.subscription.unsubscribe()}setDataTransferStatus(){this.editBranchForm.disable(),this.transferData=!0,this.submitBtnIcon="pi pi-spinner pi-spin",this.submitBtnLabel="Please wait"}unsetDataTransferStatus(){this.editBranchForm.enable(),this.transferData=!1,this.submitBtnIcon="pi pi-plus",this.submitBtnLabel="Update Branch"}getBranch(r){setTimeout(()=>{this.store.dispatch(L({status:!0}))}),this.subscription=this.branchService.getBranch(r).pipe(D(e=>e.message)).subscribe(e=>{let n=["code","name","createdBy"],c=M({},e);this.encryptionService.decryptObjectValues(c,n),this.branch=c,this.editBranchForm.patchValue(c),setTimeout(()=>{this.store.dispatch(L({status:!1}))})},e=>{this.messageService.add({closable:!1,life:6e3,icon:"pi pi-times",summary:e.error.message}),setTimeout(()=>{this.store.dispatch(L({status:!1}))}),this.router.navigate(["/system_data/branches"])})}getFormData(){return{id:this.branch._id,name:this.encryptionService.encryptData(this.editBranchForm.get("name").value)}}updateBranch(r){this.confirmationService.confirm({target:r.target,message:"Are you sure to edit this branch?",icon:"pi pi-exclamation-triangle",accept:()=>{this.setDataTransferStatus(),this.subscription=this.branchService.updateBranch(this.getFormData()).subscribe(e=>{this.unsetDataTransferStatus(),this.messageService.add({closable:!1,life:6e3,icon:"pi pi-check",summary:e.message})},e=>{this.unsetDataTransferStatus(),this.messageService.add({closable:!1,life:6e3,icon:"pi pi-times",summary:e.error.message})})}})}};i.\u0275fac=function(e){return new(e||i)(l(B),l(x),l(P),l(T),l(F),l(ae),l(N),l(ue))},i.\u0275cmp=g({type:i,selectors:[["app-edit-branch"]],decls:22,vars:7,consts:[[1,"grid"],[1,"col-12"],[1,"card"],[3,"formGroup"],[1,"grid","p-fluid","mt-3"],[1,"field","col-12","md:col-4"],[1,"p-float-label"],["formControlName","code","type","text","id","code","readonly","","pInputText",""],["for","code"],[1,"field","col-12","md:col-8"],["formControlName","name","type","text","id","name","pInputText",""],["for","name"],[1,"block","md:flex","md:justify-content-between"],["styleClass","justify-content-center w-full md:w-8rem mb-3 md:mb-0","pRipple","","label","Back","icon","pi pi-arrow-left","routerLink","/system_data/branches",1,"block",3,"raised","disabled"],["styleClass","justify-content-center w-full md:w-10rem","pRipple","","severity","success",1,"block",3,"raised","label","icon","disabled","click"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),s(4,"Edit Branch"),a(),t(5,"p"),s(6,"You can edit/update details of branches details through this page."),a(),t(7,"form",3)(8,"div",4)(9,"div",5)(10,"span",6),d(11,"input",7),t(12,"label",8),s(13,"Branch code"),a()()(),t(14,"div",9)(15,"span",6),d(16,"input",10),t(17,"label",11),s(18,"Branch name"),a()()()()(),t(19,"div",12),d(20,"p-button",13),t(21,"p-button",14),b("click",function(p){return n.updateBranch(p)}),a()()()()()),e&2&&(m(7),u("formGroup",n.editBranchForm),m(13),u("raised",!0)("disabled",n.transferData),m(1),u("raised",!0)("label",n.submitBtnLabel)("icon",n.submitBtnIcon)("disabled",n.editBranchForm.invalid||n.transferData))},dependencies:[S,w,E,_,q,G,O,U,Q,$]});let o=i;return o})();var He=[{path:"",component:Ee},{path:"add",component:De},{path:"edit/:id",component:je}],ke=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=R({type:i}),i.\u0275inj=V({imports:[X.forChild(He),X]});let o=i;return o})();var Et=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=R({type:i}),i.\u0275inj=V({imports:[ne,ke,pe,fe,ce,se,Be,me,be,he]});let o=i;return o})();export{Et as BranchesModule};
